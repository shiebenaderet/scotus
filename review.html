<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review | SCOTUS Debate Project</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/case.css">
    <style>
        /* REVIEW PAGE SPECIFIC STYLES */
        .review-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* NAVIGATION BUTTONS */
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .nav-btn {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-light) 100%);
            color: var(--text-light);
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(26, 35, 50, 0.4);
        }

        .nav-btn.secondary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
        }

        .nav-btn.success {
            background: linear-gradient(135deg, #4facfe 0%, #00c6fb 100%);
        }

        /* SECTIONS */
        .section { display: none; }
        .section.active { display: block; }

        /* PROGRESS BAR */
        .progress-bar {
            background: #e0e0e0;
            height: 30px;
            border-radius: 15px;
            overflow: visible;
            margin: 20px 0;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4facfe 0%, #00c6fb 100%);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 15px;
        }

        .progress-bar .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            z-index: 1;
        }

        /* STATS GRID */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-light) 100%);
            color: var(--text-light);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-weight: 700;
            font-size: 0.95em;
        }

        /* QUESTION CARD */
        .question-card {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 5px solid var(--primary-dark);
        }

        .question-card h3 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .question-card .question-topic {
            display: inline-block;
            background: #e0e7ff;
            color: var(--primary-dark);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        /* MULTIPLE CHOICE OPTIONS */
        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .option {
            padding: 15px 20px;
            background: var(--bg-white);
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1em;
        }

        .option:hover {
            border-color: var(--primary-dark);
            background: #f0f4ff;
        }

        .option.selected {
            border-color: var(--primary-dark);
            background: #e0e7ff;
        }

        .option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }

        .option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }

        /* FEEDBACK */
        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }

        .feedback.show { display: block; }

        .feedback.correct {
            background: #d1fae5;
            border-left: 5px solid #10b981;
        }

        .feedback.incorrect {
            background: #fee2e2;
            border-left: 5px solid #ef4444;
        }

        .feedback h4 { margin-bottom: 10px; }

        /* SHORT ANSWER */
        .short-answer-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            margin: 15px 0;
        }

        .short-answer-area:focus {
            outline: none;
            border-color: var(--primary-dark);
        }

        .exemplar {
            background: #f0f4ff;
            border-left: 4px solid var(--primary-dark);
            padding: 15px 20px;
            border-radius: 0 10px 10px 0;
            margin: 15px 0;
            display: none;
        }

        .exemplar.show { display: block; }

        .exemplar h4 {
            color: var(--primary-dark);
            margin-bottom: 8px;
        }

        .rubric-checklist {
            margin: 15px 0;
            display: none;
        }

        .rubric-checklist.show { display: block; }

        .rubric-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
        }

        .rubric-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        /* SORTING ACTIVITY */
        .sort-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }

        .sort-items {
            flex: 1;
            background: var(--bg-light);
            padding: 20px;
            border-radius: 15px;
            max-height: 600px;
            overflow-y: auto;
        }

        .sort-items h3 {
            position: sticky;
            top: 0;
            background: var(--bg-light);
            padding: 10px 0;
            margin: -10px 0 10px 0;
            z-index: 10;
        }

        .sort-zones {
            flex: 1.2;
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
        }

        .sort-item {
            background: var(--bg-white);
            border: 3px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            cursor: move;
            transition: all 0.3s;
            user-select: none;
        }

        .sort-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border-color: var(--primary-dark);
        }

        .sort-item.dragging { opacity: 0.5; }

        .sort-item.placed {
            cursor: default;
            background: #f0f4ff;
        }

        .sort-item.correct {
            border-color: #10b981;
            background: #d1fae5;
        }

        .sort-item.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }

        .sort-item .item-title {
            font-weight: bold;
            color: var(--primary-dark);
            font-size: 1em;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .drop-zone {
            background: var(--bg-white);
            border: 3px dashed #ccc;
            border-radius: 12px;
            padding: 15px;
            min-height: 80px;
            transition: all 0.3s;
        }

        .drop-zone.drag-over {
            background: #e0e7ff;
            border-color: var(--primary-dark);
            border-style: solid;
        }

        .drop-zone h4 {
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid currentColor;
            margin-bottom: 10px;
            color: var(--primary-dark);
        }

        .drop-zone .empty-message {
            text-align: center;
            padding: 15px 10px;
            color: #999;
            font-style: italic;
            font-size: 0.9em;
        }

        .drop-zone .sort-item {
            margin-bottom: 8px;
        }

        /* BUTTONS */
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-light) 100%);
            color: var(--text-light);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26, 35, 50, 0.4);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover { background: #d0d0d0; }

        .btn-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .btn-danger:hover { background: #fecaca; }

        /* ALERTS */
        .review-content .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .review-content .alert.info {
            background: #dbeafe;
            border-left: 5px solid #3b82f6;
            color: #1e40af;
        }

        .review-content .alert.success {
            background: #d1fae5;
            border-left: 5px solid #10b981;
            color: #065f46;
        }

        /* FLASHCARDS */
        .flashcard {
            perspective: 1000px;
            width: 100%;
            max-width: 600px;
            height: 280px;
            margin: 30px auto;
            cursor: pointer;
        }

        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }

        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            text-align: center;
        }

        .flashcard-front {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-light) 100%);
            color: var(--text-light);
            border: 3px solid var(--primary-light);
        }

        .flashcard-front h3 {
            font-size: 1.6em;
            margin-bottom: 10px;
        }

        .flashcard-back {
            background: #f0f4ff;
            border: 3px solid var(--primary-dark);
            transform: rotateY(180deg);
        }

        .flashcard-back p {
            font-size: 1.15em;
            line-height: 1.6;
            color: var(--text-dark);
        }

        .flashcard-back .card-label {
            font-size: 0.8em;
            font-weight: 700;
            color: var(--primary-dark);
            background: #dbeafe;
            padding: 4px 12px;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .flashcard.known .flashcard-front {
            border-color: #10b981;
        }

        .flashcard.known .flashcard-front::after {
            content: 'Mastered';
            position: absolute;
            top: 12px;
            right: 12px;
            background: #10b981;
            color: white;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .card-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .flip-indicator {
            text-align: center;
            color: #999;
            font-style: italic;
            font-size: 0.9em;
            margin: 10px 0;
        }

        .keyboard-hint {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 15px 0;
            font-size: 0.85em;
            color: #888;
        }

        .keyboard-hint .key {
            display: inline-block;
            background: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 2px 8px;
            font-family: monospace;
            font-size: 0.9em;
            min-width: 24px;
            text-align: center;
        }

        .reset-btn {
            background: none;
            border: none;
            color: #ef4444;
            cursor: pointer;
            font-size: 0.9em;
            text-decoration: underline;
            margin-top: 10px;
        }

        .reset-btn:hover {
            color: #dc2626;
        }

        /* SAVE/LOAD */
        .save-load-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border);
            text-align: center;
        }

        .save-load-section p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .sort-container { flex-direction: column; }
            .flashcard { height: 240px; }
            .flashcard-front h3 { font-size: 1.3em; }
            .keyboard-hint { display: none; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 600px) {
            .review-content { padding: 15px; }
            .nav-buttons { grid-template-columns: 1fr; }
            .flashcard { height: 220px; }
            .stats-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <header class="site-header" role="banner">
        <div class="container header-inner">
            <a href="index.html" class="site-logo">
                <span class="logo-icon">⚖️</span>
                <span class="logo-text">SCOTUS Debate Project</span>
            </a>
            <nav class="header-nav" role="navigation" aria-label="Main navigation">
                <a href="index.html#cases">Cases</a>
                <a href="resources.html">Resources</a>
                <a href="index.html">Home</a>
            </nav>
        </div>
    </header>

    <main id="main-content" role="main">
        <section class="case-header">
            <div class="container">
                <h1>SCOTUS Review</h1>
            </div>
        </section>

        <div class="review-content">
            <!-- HOME / DASHBOARD -->
            <div id="home" class="section active">
                <h2>Review Dashboard</h2>
                <p style="margin: 10px 0 20px; color: #666;">Review what you've learned about Supreme Court cases and the Bill of Rights.</p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="number" id="vocab-score">0/24</div>
                        <div class="label">Vocab Mastered</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="mc-score">0%</div>
                        <div class="label">Multiple Choice</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="sa-score">0/5</div>
                        <div class="label">Short Answer</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="sort-score">0%</div>
                        <div class="label">Amendments Sort</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="nav-btn" onclick="showSection('vocab')">Vocabulary</button>
                    <button class="nav-btn secondary" onclick="showSection('practice')">Multiple Choice</button>
                    <button class="nav-btn" onclick="showSection('shortanswer')">Short Answer</button>
                    <button class="nav-btn success" onclick="showSection('sort')">Amendments Sort</button>
                </div>

                <div class="alert info">
                    <span>This review covers key concepts from the SCOTUS cases and the Bill of Rights. Complete each section to track your progress.</span>
                </div>

                <div class="save-load-section">
                    <p>Your progress is saved automatically in this browser. Use the buttons below to back up or transfer your progress.</p>
                    <button class="btn btn-primary" onclick="saveAllProgress()">Save Progress</button>
                    <button class="btn btn-secondary" onclick="document.getElementById('load-file').click()">Load Progress</button>
                    <input type="file" id="load-file" accept=".json" style="display:none" onchange="loadAllProgress(event)">
                    <br>
                    <button class="reset-btn" onclick="resetAllProgress()">Reset All Progress</button>
                </div>
            </div>

            <!-- VOCABULARY FLASHCARDS -->
            <div id="vocab" class="section">
                <button class="btn btn-secondary" onclick="showSection('home')">Back to Dashboard</button>

                <h2 style="margin: 20px 0;">Vocabulary Flashcards</h2>

                <div class="progress-bar">
                    <div class="progress-fill" id="vocabProgressBar" style="width: 0%"></div>
                    <div class="progress-text" id="vocabProgress">0/24 terms mastered (0%)</div>
                </div>

                <div id="flashcardContainer"></div>

                <div class="card-controls">
                    <button class="btn btn-secondary" onclick="prevCard()">Previous</button>
                    <button class="btn btn-primary" onclick="markKnown()">I Know This</button>
                    <button class="btn btn-secondary" onclick="nextCard()">Next</button>
                </div>

                <p class="flip-indicator">Click the card to flip between term and definition</p>

                <div class="keyboard-hint">
                    <span><span class="key">&#8592;</span> <span class="key">&#8594;</span> Navigate cards</span>
                    <span><span class="key">Space</span> Flip card</span>
                    <span><span class="key">K</span> Mark known</span>
                    <span><span class="key">Esc</span> Home</span>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="shuffleCards()">Shuffle Cards</button>
                    <br>
                    <button class="reset-btn" onclick="resetVocabProgress()">Reset Vocabulary Progress</button>
                </div>
            </div>

            <!-- MULTIPLE CHOICE -->
            <div id="practice" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>Multiple Choice</h2>
                    <button class="btn btn-secondary" onclick="showSection('home')">Back</button>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="mc-progress" style="width: 0%"></div>
                    <span class="progress-text" id="mc-progress-text">Question 1 of 10</span>
                </div>

                <div id="mc-question-area">
                    <div class="alert info">
                        <span>Questions will be added here. Click "Start" when ready.</span>
                    </div>
                    <button class="btn btn-primary" onclick="startMultipleChoice()">Start</button>
                </div>
            </div>

            <!-- SHORT ANSWER -->
            <div id="shortanswer" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>Short Answer</h2>
                    <button class="btn btn-secondary" onclick="showSection('home')">Back</button>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="sa-progress" style="width: 0%"></div>
                    <span class="progress-text" id="sa-progress-text">Question 1 of 5</span>
                </div>

                <div id="sa-question-area">
                    <div class="alert info">
                        <span>Short answer questions will be added here. Click "Start" when ready.</span>
                    </div>
                    <button class="btn btn-primary" onclick="startShortAnswer()">Start</button>
                </div>
            </div>

            <!-- AMENDMENTS SORT -->
            <div id="sort" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>Bill of Rights Sort</h2>
                    <button class="btn btn-secondary" onclick="showSection('home')">Back</button>
                </div>

                <div class="alert info">
                    <span>Drag each right or protection to the correct amendment. The first ten amendments to the Constitution make up the Bill of Rights.</span>
                </div>

                <div class="sort-container">
                    <div class="sort-items" id="sort-items-panel">
                        <h3>Rights & Protections</h3>
                        <div id="sort-items-list"></div>
                    </div>

                    <div class="sort-zones" id="sort-zones-panel"></div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="checkSort()">Check Answers</button>
                    <button class="btn btn-secondary" onclick="resetSort()">Reset</button>
                </div>

                <div id="sort-feedback"></div>
            </div>
        </div>
    </main>

    <footer role="contentinfo">
        <div class="container">
            <p><a href="index.html">Back to Home</a></p>
            <p>&copy; 2026 SCOTUS Debate Project | Educational Resource</p>
        </div>
    </footer>

    <script>
    // ==========================================
    // SECTION NAVIGATION
    // ==========================================
    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0, 0);
    }

    // ==========================================
    // MULTIPLE CHOICE DATA (placeholder - content to be added)
    // ==========================================
    const multipleChoiceQuestions = [
        // Example structure:
        // {
        //     topic: "Fourth Amendment",
        //     question: "In Payton v. New York, what did the Court rule about warrantless home arrests?",
        //     options: [
        //         "Police can enter homes without warrants if they have probable cause",
        //         "Police need a warrant to enter a home to make an arrest",
        //         "Police only need a warrant for felony arrests",
        //         "Warrants are never required for arrests"
        //     ],
        //     correct: 1,
        //     explanation: "The Court ruled that the Fourth Amendment requires police to obtain a warrant before entering a person's home to make an arrest."
        // }
    ];

    let currentMCQuestion = 0;
    let mcAnswers = {};
    let mcShuffled = [];

    function startMultipleChoice() {
        if (multipleChoiceQuestions.length === 0) {
            document.getElementById('mc-question-area').innerHTML =
                '<div class="alert info"><span>No questions have been added yet. Check back soon!</span></div>' +
                '<button class="btn btn-secondary" onclick="showSection(\'home\')">Back to Dashboard</button>';
            return;
        }
        mcShuffled = [...multipleChoiceQuestions].sort(() => Math.random() - 0.5).slice(0, 10);
        currentMCQuestion = 0;
        mcAnswers = {};
        renderMCQuestion();
    }

    function renderMCQuestion() {
        if (currentMCQuestion >= mcShuffled.length) {
            showMCResults();
            return;
        }
        const q = mcShuffled[currentMCQuestion];
        const progress = ((currentMCQuestion) / mcShuffled.length) * 100;
        document.getElementById('mc-progress').style.width = progress + '%';
        document.getElementById('mc-progress-text').textContent =
            `Question ${currentMCQuestion + 1} of ${mcShuffled.length}`;

        let html = `<div class="question-card">`;
        if (q.topic) html += `<span class="question-topic">${q.topic}</span>`;
        html += `<h3>${q.question}</h3><div class="options">`;
        q.options.forEach((opt, i) => {
            html += `<div class="option" onclick="selectMCOption(${i})" id="mc-opt-${i}">${opt}</div>`;
        });
        html += `</div></div>`;
        html += `<div id="mc-feedback" class="feedback"></div>`;
        html += `<div style="text-align:center; margin-top:15px;">`;
        html += `<button class="btn btn-primary" id="mc-check-btn" onclick="checkMCAnswer()" disabled>Check Answer</button>`;
        html += `</div>`;

        document.getElementById('mc-question-area').innerHTML = html;
    }

    let mcSelected = null;

    function selectMCOption(index) {
        mcSelected = index;
        document.querySelectorAll('#mc-question-area .option').forEach((el, i) => {
            el.classList.toggle('selected', i === index);
        });
        document.getElementById('mc-check-btn').disabled = false;
    }

    function checkMCAnswer() {
        const q = mcShuffled[currentMCQuestion];
        const isCorrect = mcSelected === q.correct;
        mcAnswers[currentMCQuestion] = isCorrect;

        document.querySelectorAll('#mc-question-area .option').forEach((el, i) => {
            el.style.pointerEvents = 'none';
            if (i === q.correct) el.classList.add('correct');
            if (i === mcSelected && !isCorrect) el.classList.add('incorrect');
        });

        const fb = document.getElementById('mc-feedback');
        fb.className = 'feedback show ' + (isCorrect ? 'correct' : 'incorrect');
        fb.innerHTML = `<h4>${isCorrect ? 'Correct!' : 'Not quite.'}</h4><p>${q.explanation || ''}</p>`;

        document.getElementById('mc-check-btn').style.display = 'none';
        const nextBtn = document.createElement('button');
        nextBtn.className = 'btn btn-primary';
        nextBtn.textContent = currentMCQuestion < mcShuffled.length - 1 ? 'Next Question' : 'See Results';
        nextBtn.onclick = function() {
            currentMCQuestion++;
            mcSelected = null;
            renderMCQuestion();
        };
        document.getElementById('mc-check-btn').parentNode.appendChild(nextBtn);
    }

    function showMCResults() {
        const correct = Object.values(mcAnswers).filter(v => v).length;
        const total = mcShuffled.length;
        const pct = Math.round((correct / total) * 100);

        document.getElementById('mc-progress').style.width = '100%';
        document.getElementById('mc-progress-text').textContent = 'Complete!';
        document.getElementById('mc-score').textContent = pct + '%';

        let html = `<div class="stats-grid">
            <div class="stat-card"><div class="number">${correct}/${total}</div><div class="label">Correct</div></div>
            <div class="stat-card"><div class="number">${pct}%</div><div class="label">Score</div></div>
        </div>`;
        html += `<div style="text-align:center; margin-top:20px;">`;
        html += `<button class="btn btn-primary" onclick="startMultipleChoice()">Try Again</button> `;
        html += `<button class="btn btn-secondary" onclick="showSection('home')">Back to Dashboard</button>`;
        html += `</div>`;

        document.getElementById('mc-question-area').innerHTML = html;
        localStorage.setItem('scotus-mc-score', pct);
    }

    // ==========================================
    // SHORT ANSWER DATA (placeholder - content to be added)
    // ==========================================
    const shortAnswerQuestions = [
        // Example structure:
        // {
        //     topic: "Judicial Review",
        //     question: "Explain why judicial review is important for the system of checks and balances.",
        //     exemplar: "Judicial review allows the Supreme Court to strike down laws...",
        //     rubric: [
        //         "Defines judicial review",
        //         "Explains connection to checks and balances",
        //         "Gives a specific reason why it matters"
        //     ]
        // }
    ];

    let currentSAQuestion = 0;

    function startShortAnswer() {
        if (shortAnswerQuestions.length === 0) {
            document.getElementById('sa-question-area').innerHTML =
                '<div class="alert info"><span>No questions have been added yet. Check back soon!</span></div>' +
                '<button class="btn btn-secondary" onclick="showSection(\'home\')">Back to Dashboard</button>';
            return;
        }
        currentSAQuestion = 0;
        renderSAQuestion();
    }

    function renderSAQuestion() {
        if (currentSAQuestion >= shortAnswerQuestions.length) {
            showSAResults();
            return;
        }
        const q = shortAnswerQuestions[currentSAQuestion];
        const progress = ((currentSAQuestion) / shortAnswerQuestions.length) * 100;
        document.getElementById('sa-progress').style.width = progress + '%';
        document.getElementById('sa-progress-text').textContent =
            `Question ${currentSAQuestion + 1} of ${shortAnswerQuestions.length}`;

        let html = `<div class="question-card">`;
        if (q.topic) html += `<span class="question-topic">${q.topic}</span>`;
        html += `<h3>${q.question}</h3>`;
        html += `<textarea class="short-answer-area" id="sa-response" placeholder="Type your answer here..."></textarea>`;
        html += `</div>`;
        html += `<div style="text-align:center; margin-top:15px;">`;
        html += `<button class="btn btn-primary" onclick="showExemplar()">Show Model Answer</button>`;
        html += `</div>`;
        html += `<div class="exemplar" id="sa-exemplar">`;
        html += `<h4>Model Answer:</h4><p>${q.exemplar || ''}</p>`;
        if (q.rubric && q.rubric.length > 0) {
            html += `<h4 style="margin-top:15px;">Rate your answer:</h4>`;
            html += `<div class="rubric-checklist show">`;
            q.rubric.forEach((item, i) => {
                html += `<div class="rubric-item"><input type="checkbox" id="rubric-${i}"><label for="rubric-${i}">${item}</label></div>`;
            });
            html += `</div>`;
        }
        html += `<div style="text-align:center; margin-top:15px;">`;
        html += `<button class="btn btn-primary" onclick="nextSAQuestion()">`;
        html += currentSAQuestion < shortAnswerQuestions.length - 1 ? 'Next Question' : 'Finish';
        html += `</button></div></div>`;

        document.getElementById('sa-question-area').innerHTML = html;
    }

    function showExemplar() {
        document.getElementById('sa-exemplar').classList.add('show');
    }

    function nextSAQuestion() {
        currentSAQuestion++;
        renderSAQuestion();
    }

    function showSAResults() {
        document.getElementById('sa-progress').style.width = '100%';
        document.getElementById('sa-progress-text').textContent = 'Complete!';
        document.getElementById('sa-score').textContent = shortAnswerQuestions.length + '/' + shortAnswerQuestions.length;

        let html = `<div class="alert success"><span>You've completed all short answer questions. Great work!</span></div>`;
        html += `<div style="text-align:center;">`;
        html += `<button class="btn btn-primary" onclick="startShortAnswer()">Try Again</button> `;
        html += `<button class="btn btn-secondary" onclick="showSection('home')">Back to Dashboard</button>`;
        html += `</div>`;

        document.getElementById('sa-question-area').innerHTML = html;
    }

    // ==========================================
    // AMENDMENTS SORT DATA
    // ==========================================
    const amendments = [
        { id: 'amend1', name: 'First Amendment', description: 'Freedom of religion, speech, press, assembly, and petition' },
        { id: 'amend2', name: 'Second Amendment', description: 'Right to bear arms' },
        { id: 'amend3', name: 'Third Amendment', description: 'No quartering of soldiers' },
        { id: 'amend4', name: 'Fourth Amendment', description: 'Protection from unreasonable searches and seizures' },
        { id: 'amend5', name: 'Fifth Amendment', description: 'Rights in criminal cases (due process, double jeopardy, self-incrimination)' },
        { id: 'amend6', name: 'Sixth Amendment', description: 'Right to a fair and speedy trial' },
        { id: 'amend7', name: 'Seventh Amendment', description: 'Right to jury trial in civil cases' },
        { id: 'amend8', name: 'Eighth Amendment', description: 'No excessive bail or cruel and unusual punishment' },
        { id: 'amend9', name: 'Ninth Amendment', description: 'Rights retained by the people' },
        { id: 'amend10', name: 'Tenth Amendment', description: 'Powers reserved to states and the people' }
    ];

    const sortItems = [
        { id: 's1', text: 'Freedom of speech', correctAmendment: 'amend1' },
        { id: 's2', text: 'Right to bear arms', correctAmendment: 'amend2' },
        { id: 's3', text: 'No soldiers housed in your home without consent', correctAmendment: 'amend3' },
        { id: 's4', text: 'Police need a warrant to search your home', correctAmendment: 'amend4' },
        { id: 's5', text: 'Cannot be tried twice for the same crime', correctAmendment: 'amend5' },
        { id: 's6', text: 'Right to a speedy trial', correctAmendment: 'amend6' },
        { id: 's7', text: 'Right to a jury in civil cases over $20', correctAmendment: 'amend7' },
        { id: 's8', text: 'No cruel and unusual punishment', correctAmendment: 'amend8' },
        { id: 's9', text: 'People have rights not listed in the Constitution', correctAmendment: 'amend9' },
        { id: 's10', text: 'Powers not given to the federal government belong to states', correctAmendment: 'amend10' },
        { id: 's11', text: 'Freedom of religion', correctAmendment: 'amend1' },
        { id: 's12', text: 'Right to petition the government', correctAmendment: 'amend1' },
        { id: 's13', text: 'Right to remain silent (self-incrimination)', correctAmendment: 'amend5' },
        { id: 's14', text: 'Freedom of the press', correctAmendment: 'amend1' },
        { id: 's15', text: 'No excessive bail', correctAmendment: 'amend8' },
    ];

    let sortPlaced = {};

    function initSort() {
        const shuffled = [...sortItems].sort(() => Math.random() - 0.5);

        const itemsList = document.getElementById('sort-items-list');
        itemsList.innerHTML = '';
        shuffled.forEach(item => {
            const el = document.createElement('div');
            el.className = 'sort-item';
            el.draggable = true;
            el.id = 'sort-' + item.id;
            el.dataset.itemId = item.id;
            el.innerHTML = `<div class="item-title">${item.text}</div>`;
            el.addEventListener('dragstart', handleDragStart);
            el.addEventListener('dragend', handleDragEnd);
            itemsList.appendChild(el);
        });

        const zonesPanel = document.getElementById('sort-zones-panel');
        zonesPanel.innerHTML = '';
        amendments.forEach(a => {
            const zone = document.createElement('div');
            zone.className = 'drop-zone';
            zone.id = 'zone-' + a.id;
            zone.dataset.amendmentId = a.id;
            zone.innerHTML = `<h4>${a.name}</h4><p class="empty-message">${a.description}<br><em>Drop items here</em></p>`;
            zone.addEventListener('dragover', handleDragOver);
            zone.addEventListener('dragleave', handleDragLeave);
            zone.addEventListener('drop', handleDrop);
            zonesPanel.appendChild(zone);
        });

        sortPlaced = {};
        document.getElementById('sort-feedback').innerHTML = '';
    }

    let draggedItem = null;

    function handleDragStart(e) {
        draggedItem = e.target.closest('.sort-item');
        draggedItem.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragEnd(e) {
        if (draggedItem) draggedItem.classList.remove('dragging');
        draggedItem = null;
        document.querySelectorAll('.drop-zone').forEach(z => z.classList.remove('drag-over'));
    }

    function handleDragOver(e) {
        e.preventDefault();
        e.currentTarget.classList.add('drag-over');
    }

    function handleDragLeave(e) {
        e.currentTarget.classList.remove('drag-over');
    }

    function handleDrop(e) {
        e.preventDefault();
        const zone = e.currentTarget;
        zone.classList.remove('drag-over');

        if (!draggedItem) return;

        const itemId = draggedItem.dataset.itemId;
        const amendmentId = zone.dataset.amendmentId;

        const emptyMsg = zone.querySelector('.empty-message');
        if (emptyMsg) emptyMsg.style.display = 'none';

        draggedItem.classList.add('placed');
        draggedItem.draggable = false;
        zone.appendChild(draggedItem);

        if (!sortPlaced[amendmentId]) sortPlaced[amendmentId] = [];
        sortPlaced[amendmentId].push(itemId);
    }

    function checkSort() {
        let correct = 0;
        let total = sortItems.length;

        document.querySelectorAll('.sort-item.placed').forEach(el => {
            const itemId = el.dataset.itemId;
            const zone = el.closest('.drop-zone');
            if (!zone) return;
            const amendmentId = zone.dataset.amendmentId;
            const item = sortItems.find(s => s.id === itemId);
            if (item && item.correctAmendment === amendmentId) {
                el.classList.add('correct');
                el.classList.remove('incorrect');
                correct++;
            } else {
                el.classList.add('incorrect');
                el.classList.remove('correct');
            }
        });

        const placed = document.querySelectorAll('.sort-item.placed').length;
        const unplaced = total - placed;

        const pct = Math.round((correct / total) * 100);
        document.getElementById('sort-score').textContent = pct + '%';
        localStorage.setItem('scotus-sort-score', pct);

        let fbHtml = `<div class="stats-grid" style="margin-top:20px;">
            <div class="stat-card"><div class="number">${correct}/${total}</div><div class="label">Correct</div></div>
            <div class="stat-card"><div class="number">${pct}%</div><div class="label">Score</div></div>
        </div>`;
        if (unplaced > 0) {
            fbHtml += `<div class="alert info" style="margin-top:15px;"><span>${unplaced} item(s) not yet placed. Drag them to an amendment to complete the activity.</span></div>`;
        }
        document.getElementById('sort-feedback').innerHTML = fbHtml;
    }

    function resetSort() {
        initSort();
    }

    // ==========================================
    // VOCABULARY FLASHCARDS
    // ==========================================
    const vocabTerms = [
        { term: "Jury", definition: "A group of ordinary citizens who listen to evidence and decide guilt or liability." },
        { term: "Judge", definition: "The person who presides over a court and makes decisions about the law and fairness." },
        { term: "Defendant", definition: "The person accused or being sued in a court case." },
        { term: "Plaintiff", definition: "The person bringing a civil lawsuit; the person suing." },
        { term: "Evidence", definition: "Documents, objects, witness testimony, or other information used to prove facts in a case." },
        { term: "Trial Court / District Court", definition: "The first court where a case is heard; evidence and testimony are presented to a judge or jury." },
        { term: "Civil Court", definition: "Handles disputes about money, property, contracts, and other non-criminal matters." },
        { term: "Criminal Court", definition: "Handles cases where someone is accused of breaking a law and could face punishment." },
        { term: "Bench Trial", definition: "A trial where a judge, not a jury, listens to evidence and makes the final decision." },
        { term: "Jury Trial", definition: "A trial where citizens (the jury) listen to evidence and decide if the defendant is guilty or liable." },
        { term: "Appellate Court", definition: "Reviews decisions from lower courts to check if the law was applied correctly." },
        { term: "Court of Appeals", definition: "An appellate court that reviews decisions from trial courts at the federal or state level." },
        { term: "Panel", definition: "A group of judges (usually 2-3) who review a case and vote on the decision." },
        { term: "Affirm", definition: "An appellate court agrees with and upholds the lower court's decision." },
        { term: "Reverse", definition: "An appellate court overturns the lower court's decision, often ordering a new trial." },
        { term: "Federal Court System", definition: "Courts established by the federal government that handle federal laws and constitutional questions." },
        { term: "State Court System", definition: "Courts in each state that handle criminal cases, civil disputes, and state/local laws." },
        { term: "Petitioner", definition: "The person or party who appeals a case to a higher court, asking the court to review the lower court's decision." },
        { term: "Respondent", definition: "The person or party being sued or appealed against; the other side in the case." },
        { term: "Precedent", definition: "A court decision that serves as an example or rule for how similar cases should be decided in the future." },
        { term: "Judicial Review", definition: "The power of courts to decide if laws and government actions are constitutional." },
        { term: "Supreme Court", definition: "The highest U.S. court; decides if laws and government actions are constitutional." },
        { term: "Birthright Citizenship", definition: "The right to become a U.S. citizen by being born in the United States, granted by the 14th Amendment." },
        { term: "Amendment", definition: "An official change or addition to a law, the Constitution, or other legal document." }
    ];

    let currentCard = 0;
    let cardOrder = [];
    let knownCards = new Set();

    function loadVocabProgress() {
        const saved = localStorage.getItem('scotus-vocab-known');
        if (saved) {
            try {
                const arr = JSON.parse(saved);
                knownCards = new Set(arr);
            } catch(e) {
                knownCards = new Set();
            }
        }
    }

    function saveVocabProgress() {
        localStorage.setItem('scotus-vocab-known', JSON.stringify([...knownCards]));
    }

    function initFlashcards() {
        loadVocabProgress();
        cardOrder = vocabTerms.map((_, i) => i);
        currentCard = 0;
        renderCard();
        updateVocabProgress();
    }

    function renderCard() {
        const idx = cardOrder[currentCard];
        const card = vocabTerms[idx];
        const isKnown = knownCards.has(idx);

        const container = document.getElementById('flashcardContainer');
        container.innerHTML = `
            <div class="flashcard${isKnown ? ' known' : ''}" id="flashcard" onclick="flipCard()">
                <div class="flashcard-inner">
                    <div class="flashcard-front">
                        <h3>${card.term}</h3>
                    </div>
                    <div class="flashcard-back">
                        <div class="card-label">Definition</div>
                        <p>${card.definition}</p>
                    </div>
                </div>
            </div>
        `;
    }

    function flipCard() {
        const el = document.getElementById('flashcard');
        if (el) el.classList.toggle('flipped');
    }

    function nextCard() {
        if (currentCard < cardOrder.length - 1) {
            currentCard++;
        } else {
            currentCard = 0;
        }
        renderCard();
    }

    function prevCard() {
        if (currentCard > 0) {
            currentCard--;
        } else {
            currentCard = cardOrder.length - 1;
        }
        renderCard();
    }

    function markKnown() {
        const idx = cardOrder[currentCard];
        if (knownCards.has(idx)) {
            knownCards.delete(idx);
        } else {
            knownCards.add(idx);
        }
        saveVocabProgress();
        renderCard();
        updateVocabProgress();
    }

    function shuffleCards() {
        cardOrder = cardOrder.sort(() => Math.random() - 0.5);
        currentCard = 0;
        renderCard();
    }

    function resetVocabProgress() {
        if (confirm('Reset all vocabulary progress? This will unmark all mastered terms.')) {
            knownCards = new Set();
            saveVocabProgress();
            renderCard();
            updateVocabProgress();
        }
    }

    function updateVocabProgress() {
        const total = vocabTerms.length;
        const known = knownCards.size;
        const pct = Math.round((known / total) * 100);
        document.getElementById('vocabProgressBar').style.width = pct + '%';
        document.getElementById('vocabProgress').textContent = `${known}/${total} terms mastered (${pct}%)`;
        document.getElementById('vocab-score').textContent = `${known}/${total}`;
    }

    // ==========================================
    // SAVE / LOAD PROGRESS
    // ==========================================
    function saveAllProgress() {
        const data = {
            version: 1,
            timestamp: new Date().toISOString(),
            vocabKnown: [...knownCards],
            mcScore: localStorage.getItem('scotus-mc-score') || null,
            sortScore: localStorage.getItem('scotus-sort-score') || null
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'scotus-review-progress.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    function loadAllProgress(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = JSON.parse(e.target.result);

                // Restore vocab
                if (data.vocabKnown && Array.isArray(data.vocabKnown)) {
                    knownCards = new Set(data.vocabKnown);
                    saveVocabProgress();
                    renderCard();
                    updateVocabProgress();
                }

                // Restore MC score
                if (data.mcScore !== null && data.mcScore !== undefined) {
                    localStorage.setItem('scotus-mc-score', data.mcScore);
                    document.getElementById('mc-score').textContent = data.mcScore + '%';
                }

                // Restore sort score
                if (data.sortScore !== null && data.sortScore !== undefined) {
                    localStorage.setItem('scotus-sort-score', data.sortScore);
                    document.getElementById('sort-score').textContent = data.sortScore + '%';
                }

                alert('Progress loaded successfully!');
            } catch(err) {
                alert('Error loading progress file. Make sure it is a valid SCOTUS review progress file.');
            }
        };
        reader.readAsText(file);
        event.target.value = '';
    }

    function resetAllProgress() {
        if (confirm('Reset ALL progress? This will clear vocabulary, quiz scores, and sort scores.')) {
            knownCards = new Set();
            saveVocabProgress();
            localStorage.removeItem('scotus-mc-score');
            localStorage.removeItem('scotus-sort-score');
            document.getElementById('mc-score').textContent = '0%';
            document.getElementById('sa-score').textContent = '0/5';
            document.getElementById('sort-score').textContent = '0%';
            renderCard();
            updateVocabProgress();
        }
    }

    // ==========================================
    // INITIALIZATION
    // ==========================================
    document.addEventListener('DOMContentLoaded', function() {
        initSort();
        initFlashcards();

        // Restore saved scores
        const savedMC = localStorage.getItem('scotus-mc-score');
        const savedSort = localStorage.getItem('scotus-sort-score');
        if (savedMC) document.getElementById('mc-score').textContent = savedMC + '%';
        if (savedSort) document.getElementById('sort-score').textContent = savedSort + '%';

        // Keyboard shortcuts for flashcards
        document.addEventListener('keydown', function(e) {
            const vocabSection = document.getElementById('vocab');
            if (!vocabSection || !vocabSection.classList.contains('active')) return;

            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

            switch(e.key) {
                case 'ArrowLeft':
                    e.preventDefault();
                    prevCard();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextCard();
                    break;
                case ' ':
                    e.preventDefault();
                    flipCard();
                    break;
                case 'k':
                case 'K':
                    e.preventDefault();
                    markKnown();
                    break;
                case 'Escape':
                    e.preventDefault();
                    showSection('home');
                    break;
            }
        });
    });
    </script>
</body>
</html>
